<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Boeing 777 - Reservas Autom√°ticas</title>
    <style>
        /* ESTILOS OTIMIZADOS PARA BOEING 777 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c0c2e 0%, #1a1a3e 100%);
            color: #f0f0f0;
            min-height: 100vh;
            padding: 15px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="1" fill="%2300a8ff" opacity="0.2"/></svg>');
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* HEADER COM NOVO DESIGN */
        .header {
            text-align: center;
            padding: 25px;
            margin-bottom: 25px;
            background: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
            border: 2px solid rgba(0, 168, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 168, 255, 0.1), transparent);
            animation: headerGlow 3s infinite;
        }
        
        @keyframes headerGlow {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        h1 {
            color: #00a8ff;
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(0, 168, 255, 0.5);
            position: relative;
        }
        
        .subtitle {
            color: #aaddff;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .status {
            background: linear-gradient(90deg, #28a745, #20c997);
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            display: inline-block;
            font-size: 15px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        /* LAYOUT PRINCIPAL */
        .dashboard {
            display: flex;
            gap: 25px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .airplane-section, .reservation-section {
            flex: 1;
            min-width: 350px;
            background: rgba(10, 20, 40, 0.7);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(0, 168, 255, 0.2);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
        }
        
        .section-title {
            color: #00a8ff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 168, 255, 0.3);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title::before {
            content: '‚úàÔ∏è';
            font-size: 1.5rem;
        }
        
        /* MAPA DE POLTRONAS BOEING 777 */
        .seat-map-container {
            background: rgba(0, 10, 25, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }
        
        .airplane-layout {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .airplane-body {
            background: rgba(100, 100, 120, 0.3);
            height: 30px;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .seat-map {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .seat-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 12px;
        }
        
        .row-label {
            width: 35px;
            text-align: center;
            color: #aaddff;
            font-weight: bold;
            font-size: 15px;
        }
        
        /* POLTRONAS ESTILO BOEING 777 */
        .seat-group {
            display: flex;
            gap: 5px;
        }
        
        .seat-group.middle {
            margin: 0 20px;
        }
        
        .seat {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            font-size: 14px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .seat:hover:not(.occupied) {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        
        .seat.selected {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.7);
            border-color: #2196F3;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 10px rgba(33, 150, 243, 0.7); }
            50% { box-shadow: 0 0 20px rgba(33, 150, 243, 0.9); }
            100% { box-shadow: 0 0 10px rgba(33, 150, 243, 0.7); }
        }
        
        .seat.available {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        
        .seat.business {
            background: linear-gradient(135deg, #FF9800, #e68900);
            color: white;
        }
        
        .seat.first-class {
            background: linear-gradient(135deg, #9C27B0, #7b1fa2);
            color: white;
        }
        
        .seat.premium {
            background: linear-gradient(135deg, #2196F3, #0d8aee);
            color: white;
        }
        
        .seat.occupied {
            background: linear-gradient(135deg, #757575, #616161);
            color: #ccc;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* PAINEL DE RESERVA MELHORADO */
        .reservation-card {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.15), rgba(0, 168, 255, 0.1));
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px solid rgba(33, 150, 243, 0.4);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .reservation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, #00a8ff, #9C27B0);
        }
        
        .reservation-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            align-items: center;
        }
        
        .reservation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .item-label {
            color: #aaddff;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .item-value {
            font-weight: bold;
            font-size: 18px;
        }
        
        .item-value.seat {
            color: #2196F3;
            text-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
        }
        
        .item-value.email {
            color: #4CAF50;
        }
        
        .item-value.code {
            color: #FF9800;
            letter-spacing: 2px;
            font-family: monospace;
            font-size: 20px;
        }
        
        .item-value.empty {
            color: #888;
            font-style: italic;
        }
        
        /* FORMUL√ÅRIO */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            color: #aaddff;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(0, 168, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 20, 40, 0.7);
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #00a8ff;
            box-shadow: 0 0 15px rgba(0, 168, 255, 0.5);
            background: rgba(0, 30, 60, 0.8);
        }
        
        .form-input::placeholder {
            color: #8899aa;
        }
        
        /* BOT√ïES */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .btn {
            padding: 18px;
            border: none;
            border-radius: 10px;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }
        
        .btn:hover::after {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, #4CAF50, #2E7D32);
            color: white;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(90deg, #45a049, #1B5E20);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
        }
        
        .btn-primary:disabled {
            background: #666;
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, #757575, #424242);
            color: white;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(90deg, #616161, #303030);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-test {
            background: linear-gradient(90deg, #9C27B0, #6A1B9A);
            color: white;
        }
        
        .btn-test:hover {
            background: linear-gradient(90deg, #8E24AA, #4A148C);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(156, 39, 176, 0.4);
        }
        
        /* LEGENDAS */
        .legends {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }
        
        /* MENSAGENS */
        .message {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 20px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            display: none;
            animation: slideIn 0.4s;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message.success {
            background: linear-gradient(90deg, rgba(76, 175, 80, 0.9), rgba(46, 125, 50, 0.9));
            border-left: 5px solid #2E7D32;
        }
        
        .message.error {
            background: linear-gradient(90deg, rgba(244, 67, 54, 0.9), rgba(183, 28, 28, 0.9));
            border-left: 5px solid #C62828;
        }
        
        .message.info {
            background: linear-gradient(90deg, rgba(33, 150, 243, 0.9), rgba(13, 71, 161, 0.9));
            border-left: 5px solid #1565C0;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* INSTRU√á√ïES */
        .instructions {
            margin-top: 25px;
            padding: 20px;
            background: rgba(0, 20, 40, 0.5);
            border-radius: 10px;
            font-size: 15px;
            color: #aaddff;
            border: 1px solid rgba(0, 168, 255, 0.2);
        }
        
        .instructions-title {
            color: #00a8ff;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ol {
            padding-left: 25px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            padding-left: 5px;
        }
        
        .instructions strong {
            color: #FF9800;
        }
        
        /* FOOTER */
        .footer {
            text-align: center;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #8899aa;
            font-size: 14px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: #00a8ff;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(0, 168, 255, 0.1);
            transition: all 0.3s;
        }
        
        .footer-link:hover {
            background: rgba(0, 168, 255, 0.3);
            transform: translateY(-3px);
        }
        
        /* RESPONSIVO */
        @media (max-width: 1200px) {
            .airplane-section, .reservation-section {
                min-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .seat {
                width: 35px;
                height: 35px;
                font-size: 13px;
            }
            
            .btn {
                padding: 15px;
                font-size: 16px;
            }
            
            .message {
                min-width: 250px;
                left: 15px;
                right: 15px;
                margin: 0 auto;
            }
        }
        
        @media (max-width: 480px) {
            .seat {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
            
            .seat-group.middle {
                margin: 0 10px;
            }
            
            .row-label {
                width: 25px;
                font-size: 13px;
            }
        }
        
        /* ESTAT√çSTICAS */
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(0, 20, 40, 0.5);
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
            border: 1px solid rgba(0, 168, 255, 0.2);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00a8ff;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #aaddff;
            font-size: 14px;
        }
        
        /* LOADER */
        .loader {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 168, 255, 0.3);
            border-top: 4px solid #00a8ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <h1>üõ©Ô∏è Sistema de Reservas Boeing 777</h1>
            <p class="subtitle">Reserva autom√°tica com envio de c√≥digo por email - Layout Otimizado</p>
            <div class="status">‚úÖ Sistema Integrado com Google Apps Script</div>
            
            <!-- ESTAT√çSTICAS -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-seats">396</div>
                    <div class="stat-label">Total de Poltronas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="available-seats">350</div>
                    <div class="stat-label">Dispon√≠veis</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="occupied-seats">46</div>
                    <div class="stat-label">Ocupadas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="reservations-today">12</div>
                    <div class="stat-label">Reservas Hoje</div>
                </div>
            </div>
        </header>
        
        <!-- DASHBOARD -->
        <div class="dashboard">
            <!-- MAPA DE POLTRONAS BOEING 777 -->
            <section class="airplane-section">
                <h2 class="section-title">Mapa de Poltronas Boeing 777</h2>
                <p style="color: #aaddff; margin-bottom: 15px;">Clique em uma poltrona dispon√≠vel para selecionar</p>
                
                <!-- LOADER -->
                <div class="loader" id="seat-loader">
                    <div class="loader-spinner"></div>
                    <p style="margin-top: 10px; color: #aaddff;">Carregando mapa de poltronas...</p>
                </div>
                
                <!-- MAPA -->
                <div class="seat-map-container">
                    <div class="airplane-layout">
                        <!-- CABINE DE PRIMEIRA CLASSE -->
                        <div style="text-align: center; color: #9C27B0; font-weight: bold; margin-bottom: 15px;">
                            ‚≠ê PRIMEIRA CLASSE (Fileiras 1-4)
                        </div>
                        
                        <div class="seat-map" id="first-class-map">
                            <!-- Primeira Classe ser√° gerada aqui -->
                        </div>
                        
                        <!-- BUSINESS CLASS -->
                        <div style="text-align: center; color: #FF9800; font-weight: bold; margin: 20px 0 15px 0;">
                            ‚ú® BUSINESS CLASS (Fileiras 5-12)
                        </div>
                        
                        <div class="seat-map" id="business-class-map">
                            <!-- Business Class ser√° gerada aqui -->
                        </div>
                        
                        <!-- CORREDOR VISUAL -->
                        <div class="airplane-body"></div>
                        
                        <!-- ECONOMY CLASS -->
                        <div style="text-align: center; color: #4CAF50; font-weight: bold; margin: 20px 0 15px 0;">
                            üí∫ ECONOMY CLASS (Fileiras 13-40)
                        </div>
                        
                        <div class="seat-map" id="economy-class-map">
                            <!-- Economy Class ser√° gerada aqui -->
                        </div>
                    </div>
                </div>
                
                <!-- LEGENDAS -->
                <div class="legends">
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #9C27B0, #7b1fa2);"></div>
                        <span>Primeira Classe</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #FF9800, #e68900);"></div>
                        <span>Business</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #4CAF50, #45a049);"></div>
                        <span>Dispon√≠vel</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #2196F3, #0d8aee);"></div>
                        <span>Premium Economy</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #757575, #616161);"></div>
                        <span>Ocupada</span>
                    </div>
                </div>
            </section>
            
            <!-- PAINEL DE RESERVA -->
            <section class="reservation-section">
                <h2 class="section-title">Sua Reserva</h2>
                
                <!-- CARD DE RESUMO -->
                <div class="reservation-card">
                    <div class="reservation-item">
                        <span class="item-label">üìç Poltrona:</span>
                        <span class="item-value seat" id="display-seat">
                            <span class="empty">N√£o selecionada</span>
                        </span>
                    </div>
                    
                    <div class="reservation-item">
                        <span class="item-label">üìß Email:</span>
                        <span class="item-value email" id="display-email">
                            <span class="empty">N√£o informado</span>
                        </span>
                    </div>
                    
                    <div class="reservation-item">
                        <span class="item-label">üìä Status:</span>
                        <span class="item-value" id="display-status">
                            <span style="color: #aaa;">Aguardando dados</span>
                        </span>
                    </div>
                    
                    <div class="reservation-item">
                        <span class="item-label">üîê C√≥digo de Check-in:</span>
                        <span class="item-value" id="display-code">
                            <span style="color: #aaa;">---</span>
                        </span>
                    </div>
                    
                    <div class="reservation-item">
                        <span class="item-label">üïê Hor√°rio:</span>
                        <span class="item-value" id="display-time">
                            <span style="color: #aaa;">--:--</span>
                        </span>
                    </div>
                </div>
                
                <!-- FORMUL√ÅRIO -->
                <div class="form-group">
                    <label for="email-input" class="form-label">
                        <span>üìß</span> Seu Email *
                    </label>
                    <input type="email" id="email-input" class="form-input" 
                           placeholder="exemplo@gmail.com" required>
                    <small style="color: #8899aa; display: block; margin-top: 8px;">
                        Voc√™ receber√° o c√≥digo de check-in neste email
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="name-input" class="form-label">
                        <span>üë§</span> Seu Nome (Opcional)
                    </label>
                    <input type="text" id="name-input" class="form-input" 
                           placeholder="Seu nome completo">
                </div>
                
                <!-- BOT√ïES -->
                <div class="action-buttons">
                    <button class="btn btn-primary" id="reserve-btn" disabled>
                        <span>üìã</span> Gerar Reserva Autom√°tica
                    </button>
                    <button class="btn btn-secondary" id="clear-btn">
                        <span>üîÑ</span> Limpar Sele√ß√£o
                    </button>
                    <button class="btn btn-test" id="test-btn">
                        <span>üß™</span> Testar Sistema
                    </button>
                </div>
                
                <!-- INSTRU√á√ïES -->
                <div class="instructions">
                    <div class="instructions-title">
                        <span>üìù</span> Como funciona o sistema
                    </div>
                    <ol>
                        <li><strong>Digite seu email</strong> acima</li>
                        <li><strong>Selecione uma poltrona</strong> no mapa do Boeing 777</li>
                        <li><strong>Clique em "Gerar Reserva Autom√°tica"</strong></li>
                        <li>O Google Forms abrir√° com sua poltrona pr√©-preenchida</li>
                        <li><strong>Confirme seu email</strong> no Forms e clique em ENVIAR</li>
                        <li><strong>Receba o c√≥digo de check-in</strong> por email automaticamente</li>
                        <li><strong>Apresente o c√≥digo no aeroporto</strong> para fazer o check-in</li>
                    </ol>
                </div>
            </section>
        </div>
        
        <!-- FOOTER -->
        <footer class="footer">
            <p>Sistema Integrado com Google Apps Script | API Funcional: ‚úÖ | Boeing 777 Layout: ‚úÖ</p>
            <div class="footer-links">
                <a href="#" class="footer-link" id="refresh-link">üîÑ Atualizar Poltronas</a>
                <a href="#" class="footer-link" id="docs-link">üìö Documenta√ß√£o</a>
                <a href="#" class="footer-link" id="support-link">üÜò Suporte</a>
            </div>
            <p style="margin-top: 15px; font-size: 12px;">
                Atualiza√ß√£o autom√°tica de poltronas a cada 30 segundos | √öltima atualiza√ß√£o: <span id="last-update">--:--:--</span>
            </p>
        </footer>
    </div>
    
    <!-- MENSAGENS FLUTUANTES -->
    <div class="message" id="message"></div>

    <script>
        // ============================================
        // CONFIGURA√á√ÉO DO SISTEMA BOEING 777
        // ============================================
        
        // URLs DO SEU SISTEMA - ALTERE CONFORME SEU GOOGLE APPS SCRIPT
        const API_URL = "https://script.google.com/macros/s/AKfycbwXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/exec";
        const FORM_URL = "https://docs.google.com/forms/d/e/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/viewform";
        const SPREADSHEET_ID = "1XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";
        
        // ============================================
        // VARI√ÅVEIS DO SISTEMA
        // ============================================
        let selectedSeat = null;
        let userEmail = "";
        let userName = "";
        let occupiedSeats = [];
        let lastUpdateTime = null;
        
        // ============================================
        // INICIALIZA√á√ÉO
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            showLoader(true);
            createSeatMap();
            loadOccupiedSeats();
            setupEventListeners();
            updateDisplay();
            updateLastUpdateTime();
            
            // Atualizar hora atual
            setInterval(updateCurrentTime, 1000);
            
            // Atualizar estat√≠sticas
            updateStats();
        });
        
        // ============================================
        // CRIA MAPA DE POLTRONAS BOEING 777
        // ============================================
        function createSeatMap() {
            createFirstClass();
            createBusinessClass();
            createEconomyClass();
        }
        
        function createFirstClass() {
            const container = document.getElementById('first-class-map');
            container.innerHTML = '';
            
            // Primeira Classe: Fileiras 1-4, configura√ß√£o 1-2-1
            const firstClassLetters = [['A'], ['D', 'G'], ['J']];
            
            for (let row = 1; row <= 4; row++) {
                createSeatRow(container, row, firstClassLetters, 'first-class');
            }
        }
        
        function createBusinessClass() {
            const container = document.getElementById('business-class-map');
            container.innerHTML = '';
            
            // Business Class: Fileiras 5-12, configura√ß√£o 2-3-2
            const businessClassLetters = [['A', 'B'], ['D', 'E', 'F'], ['H', 'J']];
            
            for (let row = 5; row <= 12; row++) {
                createSeatRow(container, row, businessClassLetters, 'business');
            }
        }
        
        function createEconomyClass() {
            const container = document.getElementById('economy-class-map');
            container.innerHTML = '';
            
            // Economy Class: Fileiras 13-40, configura√ß√£o 3-4-3
            const economyClassLetters = [['A', 'B', 'C'], ['D', 'E', 'F', 'G'], ['H', 'J', 'K']];
            
            for (let row = 13; row <= 40; row++) {
                createSeatRow(container, row, economyClassLetters, row >= 13 && row <= 20 ? 'premium' : 'available');
            }
        }
        
        function createSeatRow(container, rowNum, seatGroups, seatType) {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'seat-row';
            
            // N√∫mero da fileira
            const rowLabel = document.createElement('div');
            rowLabel.className = 'row-label';
            rowLabel.textContent = rowNum < 10 ? `0${rowNum}` : rowNum;
            rowDiv.appendChild(rowLabel);
            
            // Cria grupos de poltronas
            seatGroups.forEach((group, groupIndex) => {
                const groupDiv = document.createElement('div');
                groupDiv.className = 'seat-group';
                if (groupIndex === 1) groupDiv.classList.add('middle');
                
                group.forEach(letter => {
                    const seatId = `${rowNum}${letter}`;
                    const seat = document.createElement('button');
                    seat.className = `seat ${seatType}`;
                    seat.textContent = letter;
                    seat.dataset.seat = seatId;
                    seat.title = `Poltrona ${seatId}`;
                    
                    // Evento de clique
                    seat.addEventListener('click', function() {
                        selectSeat(seatId);
                    });
                    
                    groupDiv.appendChild(seat);
                });
                
                rowDiv.appendChild(groupDiv);
            });
            
            container.appendChild(rowDiv);
        }
        
        // ============================================
        // CARREGA POLTRONAS OCUPADAS DA API
        // ============================================
        function loadOccupiedSeats() {
            showMessage('üîÑ Carregando poltronas ocupadas...', 'info');
            
            // Simula√ß√£o de dados - Substitua pelo seu endpoint real
            setTimeout(() => {
                // Dados de exemplo para Boeing 777
                occupiedSeats = [
                    "1A", "2D", "3G", "4J",           // Primeira Classe
                    "5A", "5B", "6E", "7F", "8H", "9J", // Business
                    "12A", "12J",                     // Business
                    "13B", "13C", "14D", "14G", "15H", "15J", // Premium Economy
                    "16A", "16K", "17B", "17J", "18C", "18H", // Premium Economy
                    "20A", "20B", "20C", "20K",       // Premium Economy
                    "21D", "22E", "23F", "24G",       // Economy
                    "25H", "26J", "27K", "28A",       // Economy
                    "29B", "30C", "31D", "32E",       // Economy
                    "33F", "34G", "35H", "36J",       // Economy
                    "37K", "38A", "39B", "40C"        // Economy
                ];
                
                updateSeatStatus();
                updateStats();
                updateLastUpdateTime();
                showLoader(false);
                showMessage(`‚úÖ Sistema carregado: ${occupiedSeats.length} poltronas ocupadas`, 'success');
            }, 1000);
        }
        
        function updateSeatStatus() {
            document.querySelectorAll('.seat').forEach(seat => {
                const seatId = seat.dataset.seat;
                
                if (occupiedSeats.includes(seatId)) {
                    seat.classList.remove('available', 'business', 'first-class', 'premium', 'selected');
                    seat.classList.add('occupied');
                    
                    if (selectedSeat === seatId) {
                        selectedSeat = null;
                        updateDisplay();
                        checkReservationReady();
                        showMessage('‚ö†Ô∏è Sua poltrona foi ocupada! Escolha outra.', 'error');
                    }
                }
            });
        }
        
        // ============================================
        // ATUALIZA ESTAT√çSTICAS
        // ============================================
        function updateStats() {
            const totalSeats = 396; // Boeing 777 t√≠pico
            const availableSeats = totalSeats - occupiedSeats.length;
            const reservationsToday = Math.floor(occupiedSeats.length * 0.3); // Simula√ß√£o
            
            document.getElementById('total-seats').textContent = totalSeats;
            document.getElementById('available-seats').textContent = availableSeats;
            document.getElementById('occupied-seats').textContent = occupiedSeats.length;
            document.getElementById('reservations-today').textContent = reservationsToday;
        }
        
        // ============================================
        // SELE√á√ÉO DE POLTRONA
        // ============================================
        function selectSeat(seatId) {
            if (occupiedSeats.includes(seatId)) {
                showMessage('‚ùå Esta poltrona j√° est√° ocupada!', 'error');
                return;
            }
            
            // Remove sele√ß√£o anterior
            if (selectedSeat) {
                const prevSeat = document.querySelector(`[data-seat="${selectedSeat}"]`);
                if (prevSeat) {
                    prevSeat.classList.remove('selected');
                    // Restaura classe original
                    if (prevSeat.classList.contains('business')) {
                        prevSeat.classList.add('business');
                    } else if (prevSeat.classList.contains('first-class')) {
                        prevSeat.classList.add('first-class');
                    } else if (prevSeat.classList.contains('premium')) {
                        prevSeat.classList.add('premium');
                    } else {
                        prevSeat.classList.add('available');
                    }
                }
            }
            
            // Seleciona nova poltrona
            selectedSeat = seatId;
            const seatElement = document.querySelector(`[data-seat="${seatId}"]`);
            if (seatElement) {
                seatElement.classList.remove('available', 'business', 'first-class', 'premium');
                seatElement.classList.add('selected');
            }
            
            updateDisplay();
            checkReservationReady();
            showMessage(`‚úÖ Poltrona ${seatId} selecionada!`, 'success');
        }
        
        // ============================================
        // ATUALIZA DISPLAY
        // ============================================
        function updateDisplay() {
            // Atualiza poltrona
            const seatDisplay = document.getElementById('display-seat');
            if (selectedSeat) {
                seatDisplay.innerHTML = `<span style="color: #2196F3; font-weight: bold;">${selectedSeat}</span>`;
            } else {
                seatDisplay.innerHTML = '<span class="empty">N√£o selecionada</span>';
            }
            
            // Atualiza email
            const emailDisplay = document.getElementById('display-email');
            if (userEmail) {
                emailDisplay.innerHTML = `<span style="color: #4CAF50;">${userEmail}</span>`;
            } else {
                emailDisplay.innerHTML = '<span class="empty">N√£o informado</span>';
            }
            
            // Atualiza status
            const statusDisplay = document.getElementById('display-status');
            if (selectedSeat && userEmail) {
                statusDisplay.innerHTML = '<span style="color: #4CAF50; font-weight: bold;">‚úÖ Pronto para reservar!</span>';
            } else if (selectedSeat) {
                statusDisplay.innerHTML = '<span style="color: #FF9800;">‚úèÔ∏è Digite seu email</span>';
            } else if (userEmail) {
                statusDisplay.innerHTML = '<span style="color: #FF9800;">üí∫ Selecione uma poltrona</span>';
            } else {
                statusDisplay.innerHTML = '<span style="color: #aaa;">‚è≥ Aguardando dados</span>';
            }
            
            // Atualiza nome se existir
            if (userName) {
                document.getElementById('display-time').innerHTML = `<span style="color: #9C27B0;">${userName}</span>`;
            }
        }
        
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-BR');
            if (!userName) {
                document.getElementById('display-time').innerHTML = `<span style="color: #8899aa;">${timeString}</span>`;
            }
        }
        
        function updateLastUpdateTime() {
            const now = new Date();
            lastUpdateTime = now;
            document.getElementById('last-update').textContent = now.toLocaleTimeString('pt-BR');
        }
        
        // ============================================
        // VERIFICA SE PODE RESERVAR
        // ============================================
        function checkReservationReady() {
            const isReady = selectedSeat !== null && 
                          userEmail !== '' && 
                          isValidEmail(userEmail) &&
                          !occupiedSeats.includes(selectedSeat);
            
            document.getElementById('reserve-btn').disabled = !isReady;
        }
        
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }
        
        // ============================================
        // CONFIGURA EVENT LISTENERS
        // ============================================
        function setupEventListeners() {
            // Email input
            document.getElementById('email-input').addEventListener('input', function() {
                userEmail = this.value.trim();
                updateDisplay();
                checkReservationReady();
            });
            
            // Nome input
            document.getElementById('name-input').addEventListener('input', function() {
                userName = this.value.trim();
                updateDisplay();
            });
            
            // Bot√£o de reserva
            document.getElementById('reserve-btn').addEventListener('click', function() {
                createReservation();
            });
            
            // Bot√£o de limpar
            document.getElementById('clear-btn').addEventListener('click', function() {
                clearSelection();
            });
            
            // Bot√£o de teste
            document.getElementById('test-btn').addEventListener('click', function() {
                testSystem();
            });
            
            // Links do footer
            document.getElementById('refresh-link').addEventListener('click', function(e) {
                e.preventDefault();
                showLoader(true);
                loadOccupiedSeats();
            });
            
            document.getElementById('docs-link').addEventListener('click', function(e) {
                e.preventDefault();
                alert('Documenta√ß√£o do Sistema Boeing 777\n\n1. API: ' + API_URL + '\n2. Formul√°rio: ' + FORM_URL + '\n3. Planilha: ' + SPREADSHEET_ID);
            });
            
            document.getElementById('support-link').addEventListener('click', function(e) {
                e.preventDefault();
                showMessage('üÜò Para suporte, entre em contato com a equipe t√©cnica.', 'info');
            });
            
            // Atualiza√ß√£o autom√°tica a cada 30 segundos
            setInterval(() => {
                loadOccupiedSeats();
            }, 30000);
        }
        
        function clearSelection() {
            // Limpa sele√ß√£o de poltrona
            if (selectedSeat) {
                const seat = document.querySelector(`[data-seat="${selectedSeat}"]`);
                if (seat) {
                    seat.classList.remove('selected');
                    // Restaura classe original
                    if (seat.classList.contains('business')) {
                        seat.classList.add('business');
                    } else if (seat.classList.contains('first-class')) {
                        seat.classList.add('first-class');
                    } else if (seat.classList.contains('premium')) {
                        seat.classList.add('premium');
                    } else {
                        seat.classList.add('available');
                    }
                }
                selectedSeat = null;
            }
            
            // Limpa formul√°rios
            document.getElementById('email-input').value = '';
            document.getElementById('name-input').value = '';
            userEmail = '';
            userName = '';
            
            updateDisplay();
            checkReservationReady();
            
            showMessage('üîÑ Sele√ß√£o limpa! Pode come√ßar uma nova reserva.', 'info');
        }
        
        // ============================================
        // CRIAR RESERVA AUTOM√ÅTICA
        // ============================================
        function createReservation() {
            if (!selectedSeat || !userEmail) return;
            
            // Verifica se a poltrona ainda est√° dispon√≠vel
            if (occupiedSeats.includes(selectedSeat)) {
                showMessage('‚ùå Esta poltrona acabou de ser ocupada!', 'error');
                loadOccupiedSeats();
                return;
            }
            
            showMessage('‚è≥ Processando sua reserva...', 'info');
            
            // Simula verifica√ß√£o de API
            setTimeout(() => {
                // Gera URL do Google Forms com dados pr√©-preenchidos
                // Ajuste os par√¢metros conforme seu formul√°rio
                const formUrl = `${FORM_URL}?usp=pp_url&` +
                              `entry.1796450485=${encodeURIComponent(selectedSeat)}&` +
                              `entry.1234567890=${encodeURIComponent(userEmail)}&` +
                              `entry.0987654321=${encodeURIComponent(userName || '')}`;
                
                // Gera c√≥digo de check-in simulado
                const checkinCode = generateCheckinCode();
                document.getElementById('display-code').innerHTML = 
                    `<span class="item-value code">${checkinCode}</span>`;
                
                // Mostra confirma√ß√£o
                showMessage(`‚úÖ Reserva gerada para poltrona ${selectedSeat}!`, 'success');
                
                // Abre o formul√°rio ap√≥s 2 segundos
                setTimeout(() => {
                    const confirmed = confirm(
                        `RESERVA PRONTA!\n\n` +
                        `‚úàÔ∏è Boeing 777\n` +
                        `üí∫ Poltrona: ${selectedSeat}\n` +
                        `üìß Email: ${userEmail}\n` +
                        `üîê C√≥digo: ${checkinCode}\n\n` +
                        `O Google Forms ser√° aberto com sua reserva pr√©-preenchida.\n\n` +
                        `üìù Complete o envio para finalizar!\n\n` +
                        `Abrir formul√°rio agora?`
                    );
                    
                    if (confirmed) {
                        window.open(formUrl, '_blank');
                        
                        // Pergunta ap√≥s alguns segundos se enviou
                        setTimeout(() => {
                            const didSubmit = confirm(
                                'Voc√™ j√° enviou o formul√°rio?\n\n' +
                                '‚úÖ Se SIM, sua reserva ser√° processada automaticamente!\n' +
                                'üìß Voc√™ receber√° o c√≥digo de confirma√ß√£o por email.\n\n' +
                                'Se N√ÉO, ainda pode completar o envio.'
                            );
                            
                            if (didSubmit) {
                                showMessage('‚úÖ Reserva enviada! Verifique seu email para o c√≥digo de check-in.', 'success');
                                
                                // Adiciona poltrona √† lista de ocupadas
                                occupiedSeats.push(selectedSeat);
                                updateSeatStatus();
                                updateStats();
                                
                                // Limpa para nova reserva
                                setTimeout(() => {
                                    clearSelection();
                                }, 5000);
                            }
                        }, 8000);
                    }
                }, 2000);
            }, 1500);
        }
        
        function generateCheckinCode() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let code = 'BOEING-';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        // ============================================
        // TESTE DO SISTEMA
        // ============================================
        function testSystem() {
            showMessage('üß™ Iniciando teste do sistema...', 'info');
            
            // Preenche email de teste
            document.getElementById('email-input').value = 'teste@boeing777.com';
            document.getElementById('email-input').dispatchEvent(new Event('input'));
            
            // Preenche nome de teste
            document.getElementById('name-input').value = 'Passageiro Teste';
            document.getElementById('name-input').dispatchEvent(new Event('input'));
            
            // Seleciona primeira poltrona dispon√≠vel
            const availableSeats = document.querySelectorAll('.seat.available, .seat.business, .seat.first-class, .seat.premium');
            let testSeat = null;
            
            for (let seat of availableSeats) {
                if (!occupiedSeats.includes(seat.dataset.seat)) {
                    testSeat = seat.dataset.seat;
                    selectSeat(testSeat);
                    break;
                }
            }
            
            if (testSeat) {
                showMessage(`üß™ Teste: Poltrona ${testSeat} selecionada`, 'info');
                
                // Mostra instru√ß√µes de teste
                setTimeout(() => {
                    alert('TESTE DO SISTEMA BOEING 777\n\n' +
                         '‚úÖ Email preenchido: teste@boeing777.com\n' +
                         '‚úÖ Nome preenchido: Passageiro Teste\n' +
                         `‚úÖ Poltrona selecionada: ${testSeat}\n\n` +
                         'O sistema est√° funcionando corretamente!\n' +
                         'Clique em "Gerar Reserva Autom√°tica" para testar o fluxo completo.');
                }, 1000);
            } else {
                showMessage('‚ùå Nenhuma poltrona dispon√≠vel para teste', 'error');
            }
        }
        
        // ============================================
        // FUN√á√ïES AUXILIARES
        // ============================================
        function showMessage(text, type) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = `message ${type}`;
            message.style.display = 'block';
            
            // Esconde ap√≥s 5 segundos
            setTimeout(() => {
                message.style.display = 'none';
            }, 5000);
        }
        
        function showLoader(show) {
            document.getElementById('seat-loader').style.display = show ? 'block' : 'none';
        }
        
        // ============================================
        // EXPORTAR DADOS (PARA DESENVOLVEDOR)
        // ============================================
        window.exportSystemConfig = function() {
            const config = {
                apiUrl: API_URL,
                formUrl: FORM_URL,
                spreadsheetId: SPREADSHEET_ID,
                occupiedSeats: occupiedSeats,
                selectedSeat: selectedSeat,
                userEmail: userEmail,
                lastUpdate: lastUpdateTime
            };
            
            console.log('Configura√ß√£o do Sistema Boeing 777:');
            console.table(config);
            alert('Configura√ß√£o exportada para o console (F12)');
            return config;
        };
    </script>
</body>
</html>
